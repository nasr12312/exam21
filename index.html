Error: Parse Error: <a onclick="navToSection("features")">ุงููููุฒุงุช</a> <a onclick="navToSection("store")">ุงููุชุฌุฑ</a> <a onclick="navToSection("reviews")">ุงูุขุฑุงุก</a> </div> <div class=nav-buttons> <button class="nav-btn-sep btn-reg-nav"onclick="showLogin("register")"> <i class="fas fa-key"></i>ุชูุนูู ููุฏ </button> <button class="nav-btn-sep btn-login-nav"onclick="showLogin("login")"> ุชุณุฌูู ุฏุฎูู </button> </div> </nav> <div id=home-view> <div id=hero class=hero-section> <img src=https://i.ibb.co/VrJsk41/Gemini-Generated-Image-u0u4kwu0u4kwu0u4.png class=hero-logo> <h1 class=hero-title>ููุตุฉ ูุฏุฑุณุฉ ูุจุฑุงุณ ุงูุชุนููููุฉ</h1> <p class=hero-subtitle>ุงูุทูู ูู ุฑุญูุฉ ุชุนููููุฉ ูุชูุงููุฉ ุชุฌูุน ุจูู ุงูุฅุจุฏุงุน ูุงูุชุทูุฑ ุงูุชููู. ููุฏู ูู ูุญุชูู ุฏุฑุงุณู ุดุงููุ ุงุฎุชุจุงุฑุงุช ุชูุงุนููุฉ ุฐููุฉุ ูุชูููู ูุณุชูุฑ ููุณุชูุงู ูู ุงููููุงุฌ ุงูุฃุฑุฏูู.</p> <div id=news-section class="news-ticker-container hidden"style="background:rgba(59,130,246,.1);border-right:4px solid var(--blue);padding:10px;border-radius:8px;margin-bottom:20px;display:inline-block"> <div class=news-label style=font-weight:700;color:var(--blue);display:inline>ุนุงุฌู:</div> <div class=news-content style=display:inline><span id=news-text>ุฃููุงู ุจูู ูู ููุตุฉ ูุจุฑุงุณ ุงูุชุนููููุฉ... ุชุงุจุนูุง ูู ุฌุฏูุฏ ููุง!</span></div> </div> <div class=action-buttons> <button class="btn-hero btn-primary-hero"onclick="showLogin("register")"><i class="fas fa-user-plus"></i>ุงุดุชุฑู ุงูุขู</button> <button class="btn-hero btn-outline-hero"style=border-color:var(--green);color:var(--green) onclick="showLogin("trial")"><i class="fas fa-rocket"></i>ุชุฌุฑุจุฉ ูุฌุงููุฉ</button> <button class="btn-hero btn-outline-hero"onclick=showPublicLibrary()><i class="fas fa-book-open"></i>ุชุตูุญ ุงูููุชุจุฉ</button> </div> </div> <div id=features> <div class=section-header> <h2>ูููุฒุงุช ุงูููุตุฉ</h2> </div> <div class=feature-grid> <div class=feature-box> <div class=feature-icon><i class="fas fa-laptop-code"></i></div> <h3>ูุธุงู ุงูุชุญุงูุงุช ุฐูู</h3> <p style=color:#94a3b8>ุงุฎุชุจุงุฑุงุช ุชูุงุนููุฉ ูุชููุนุฉ ูุน ุชุตุญูุญ ุชููุงุฆู ููุฑู ููุชุงุฆุฌ ุฏูููุฉ.</p> </div> <div class=feature-box> <div class=feature-icon><i class="fas fa-chart-pie"></i></div> <h3>ุชุญููู ุฃุฏุงุก ูุชุทูุฑ</h3> <p style=color:#94a3b8>ุฑุณูู ุจูุงููุฉ ุชูุถุญ ููุงุท ุงูููุฉ ูุงูุถุนู ูุฏูู ูููุงุฑูุฉ ูุณุชูุงู.</p> </div> <div class=feature-box> <div class=feature-icon><i class="fas fa-certificate"></i></div> <h3>ุดูุงุฏุงุช ุชูุฏูุฑ ููุฑูุฉ</h3> <p style=color:#94a3b8>ุงุญุตู ุนูู ุดูุงุฏุงุช ููุซูุฉ ุนูุฏ ุงุฌุชูุงุฒู ุงูุงุฎุชุจุงุฑุงุช ุจุชููู.</p> </div> <div class=feature-box> <div class=feature-icon><i class="fas fa-book-reader"></i></div> <h3>ููุชุจุฉ ุดุงููุฉ</h3> <p style=color:#94a3b8>ุดุฑูุญุงุช ููุฏูู ููููุงุช PDF ููู ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ ูู ููุงู ูุงุญุฏ.</p> </div> </div> </div> <div id=store> <div class=section-header> <h2>ุจุงูุงุช ุงูุงุดุชุฑุงู</h2> </div> <div class=pricing-grid> <div class="price-card popular"> <h3 class=plan-name>ุงูุจุงูุฉ ุงูุฐูุจูุฉ</h3> <div class=plan-price><span id=disp-price-gold>15 JD</span></div> <ul class=plan-features> <li><i class="fas fa-check-circle"></i>ูุตูู ูุงูู ููุงูุชุญุงูุงุช</li> <li><i class="fas fa-check-circle"></i>ููุชุจุฉ ุงูููุฏูู ูุงููููุงุช</li> <li><i class="fas fa-check-circle"></i>ุชูุงุฑูุฑ ุฃุฏุงุก ูุชูุฏูุฉ</li> <li><i class="fas fa-check-circle"></i>ุฏุนู ููู ูุจุงุดุฑ</li> </ul> <button class="btn btn-p"onclick="buyPlan("ุงูุจุงูุฉ ุงูุฐูุจูุฉ")">ุงุดุชุฑู ุงูุขู</button> </div> <div class=price-card> <h3 class=plan-name>ุงูุจุงูุฉ ุงููุตููุฉ</h3> <div class=plan-price><span id=disp-price-term>35 JD</span></div> <ul class=plan-features> <li><i class="fas fa-check-circle"></i>ุงุดุชุฑุงู ููุฏุฉ ูุตู ูุงูู</li> <li><i class="fas fa-check-circle"></i>ุฌููุน ูููุฒุงุช ุงูุฐูุจูุฉ</li> <li><i class="fas fa-check-circle"></i>ุญุตุต ูุฑุงุฌุนุฉ ูุจุงุดุฑุฉ</li> <li><i class="fas fa-check-circle"></i>ุฃููููุฉ ูู ุงูุฑุฏ</li> </ul> <button class="btn btn-o"onclick="buyPlan("ุงูุจุงูุฉ ุงููุตููุฉ")">ุทูุจ ุงูููุฏ</button> </div> </div> </div> <div id=reviews> <div class=section-header> <h2>ูุงููุง ุนู ุงูููุตุฉ</h2> </div> <div class=reviews-grid> <div class=review-card> <div class=stars><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div> <p class=review-text>"ููุตุฉ ุฑุงุฆุนุฉ ุฌุฏุงูุ ุณุงุนุฏุชูู ูู ุชูุธูู ุฏุฑุงุณุชู ูุชุญุณูู ุนูุงูุงุชู ุจุดูู ููุญูุธ. ุฃูุตุญ ุงูุฌููุน ุจูุง!"</p> <div class=reviewer> <img src=https://cdn-icons-png.flaticon.com/512/3135/3135715.png> <div><h5 style=margin:0>ุฃุญูุฏ ูุญูุฏ</h5><small style=color:#94a3b8>ุทุงูุจ ุชูุฌููู</small></div> </div> </div> <div class=review-card> <div class=stars><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div> <p class=review-text>"ุฃูุถู ููุฒุฉ ูู ุงูุดูุงุฏุงุช ุงูููุฑูุฉ ูุชุญููู ุงูุฃุฏุงุกุ ุจุชุนุทูู ุฏุงูุน ูุจูุฑ ููุงุณุชูุฑุงุฑ."</p> <div class=reviewer> <img src=https://cdn-icons-png.flaticon.com/512/3135/3135823.png> <div><h5 style=margin:0>ุนูุฑ ุฎุงูุฏ</h5><small style=color:#94a3b8>ุงูุตู ุงูุชุงุณุน</small></div> </div> </div> <div class=review-card> <div class=stars><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div> <p class=review-text>"ููุช ุฃุนุงูู ูู ูุงุฏุฉ ุงููุบุฉ ุงูุนุฑุจูุฉุ ููู ุจูุถู ุดุฑูุญุงุช ูุจุฑุงุณ ุญุตูุช ุนูู ุงูุนูุงูุฉ ุงููุงููุฉ."</p> <div class=reviewer> <img src=https://cdn-icons-png.flaticon.com/512/3135/3135768.png> <div><h5 style=margin:0>ุณุงุฑุฉ ุงูุนูู</h5><small style=color:#94a3b8>ุฃูู ุซุงููู</small></div> </div> </div> <div class=review-card> <div class=stars><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i></div> <p class=review-text>"ุงูููุชุจุฉ ุบููุฉ ุฌุฏุงู ุจุงููููุงุช ุงููููุฏุฉุ ูุชูููุฑ ุงูุงูุชุญุงูุงุช ุงูุชุฌุฑูุจูุฉ ุณุงุนุฏูู ุนูู ูุณุฑ ุญุงุฌุฒ ุงูุฎูู."</p> <div class=reviewer> <img src=https://cdn-icons-png.flaticon.com/512/194/194938.png> <div><h5 style=margin:0>ุฃู ููุณู</h5><small style=color:#94a3b8>ูููุฉ ุฃูุฑ</small></div> </div> </div> <div class=review-card> <div class=stars><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div> <p class=review-text>"ุงูุฏุนู ุงูููู ูุชููุฒ ูุณุฑูุนุ ูุงูููุตุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู ุฌุฏุงู."</p> <div class=reviewer> <img src=https://cdn-icons-png.flaticon.com/512/147/147144.png> <div><h5 style=margin:0>ุฎุงูุฏ ุฌูุงู</h5><small style=color:#94a3b8>ุงูุตู ุงูุนุงุดุฑ</small></div> </div> </div> </div> </div> <div id=faq> <div class=section-header> <h2>ุฃุณุฆูุฉ ุดุงุฆุนุฉ</h2> </div> <div class=faq-container> <div class=faq-item onclick=toggleFaq(this)> <div class=faq-question> ููู ูููููู ุงูุงุดุชุฑุงู ูู ุงูููุตุฉุ <i class="fas fa-chevron-down faq-toggle"></i> </div> <div class=faq-answer> ููููู ุงูุงุดุชุฑุงู ุนู ุทุฑูู ุดุฑุงุก ููุฏ ุชูุนูู ูู ููุงุท ุงูุจูุน ุงููุนุชูุฏุฉ ุฃู ุงูุชูุงุตู ูุนูุง ุนุจุฑ ุงููุงุชุณุงุจ ููุญุตูู ุนูู ุงูููุฏ ูุจุงุดุฑุฉ. </div> </div> <div class=faq-item onclick=toggleFaq(this)> <div class=faq-question> ูู ูููููู ุชุฌุฑุจุฉ ุงูููุตุฉ ูุจู ุงูุฏูุนุ <i class="fas fa-chevron-down faq-toggle"></i> </div> <div class=faq-answer> ูุนูุ ูููุฑ ุฎูุงุฑ "ุชุฌุฑุจุฉ ูุฌุงููุฉ" ูุชูุญ ูู ุงููุตูู ูููุญุชูู ููุฏุฉ 24 ุณุงุนุฉ ูุชุฌุฑุจุฉ ูููุฒุงุช ุงูููุตุฉ ูุจู ุงูุงุดุชุฑุงู. </div> </div> <div class=faq-item onclick=toggleFaq(this)> <div class=faq-question> ูู ูููููู ูุชุญ ุงูููุตุฉ ูู ุฃูุซุฑ ูู ุฌูุงุฒุ <i class="fas fa-chevron-down faq-toggle"></i> </div> <div class=faq-answer> ูุนูุ ููููู ุงูุฏุฎูู ูู ูุงุชูู ุฃู ุฌูุงุฒ ุงูููุจููุชุฑ ุฃู ุงูุชุงุจูุชุ ูููู ููุถู ุงุณุชุฎุฏุงู ุฌูุงุฒ ูุงุญุฏ ูุถูุงู ุงุณุชูุฑุงุฑ ุงูุฌูุณุฉ. </div> </div> <div class=faq-item onclick=toggleFaq(this)> <div class=faq-question> ูู ุงููุญุชูู ูุญุฏุซ ุญุณุจ ุงููููุงุฌ ุงูุฌุฏูุฏุ <i class="fas fa-chevron-down faq-toggle"></i> </div> <div class=faq-answer> ุจุงูุชุฃููุฏุ ูุชู ุชุญุฏูุซ ูุงูุฉ ุงูุดุฑูุญุงุช ูุงููููุงุช ุจุดูู ุฏูุฑู ูุชุชูุงูู ูุน ุขุฎุฑ ุชุนุฏููุงุช ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ูุงูุชุนููู ุงูุฃุฑุฏููุฉ. </div> </div> <div class=faq-item onclick=toggleFaq(this)> <div class=faq-question> ูุง ูู ุทุฑู ุงูุฏูุน ุงููุชููุฑุฉุ <i class="fas fa-chevron-down faq-toggle"></i> </div> <div class=faq-answer> ูููุฑ ุทุฑู ุฏูุน ูุชุนุฏุฏุฉ ุชุดูู ุงููุญุงูุธ ุงูุฅููุชุฑูููุฉ (ุฒูู ูุงุดุ ุฃูุฑุงูุฌ ูููู) ูุงูุชุญููู ุงูุจููู. ุชูุงุตู ูุนูุง ููุฒูุฏ ูู ุงูุชูุงุตูู. </div> </div> <div class=faq-item onclick=toggleFaq(this)> <div class=faq-question> ููู ูููููู ุงูุชูุงุตู ูุน ุงููุนููุ <i class="fas fa-chevron-down faq-toggle"></i> </div> <div class=faq-answer> ููููู ุงูุชูุงุตู ุงููุจุงุดุฑ ุนุจุฑ ูุฌููุนุงุช ุงููุงุชุณุงุจ ุงูุฎุงุตุฉ ุจูู ุตูุ ุฃู ุฅุฑุณุงู ุงุณุชูุณุงุฑู ูู ุฎูุงู ูุธุงู ุงูุดูุงูู ุฏุงุฎู ููุญุฉ ุงูุทุงูุจ. </div> </div> </div> </div> </div> <div id=public-library-ui class=hidden> <div class=section-header> <button class="btn btn-o"style=position:absolute;right:0;width:auto onclick=goHome()> <i class="fas fa-arrow-right"></i>ุนูุฏุฉ </button> <h2>ุงูููุชุจุฉ ุงูุนุงูุฉ</h2> <p style=color:#94a3b8>ูุตุงุฏุฑ ุชุนููููุฉ ููุชูุญุฉ ููุจุญุซ ูุงูุงุทูุงุน</p> </div> <div class=search-box> <input id=lib-search-input placeholder="๐ ุงุจุญุซ ุนู ุงุณู ุงููููุ ุงููุงุฏุฉุ ุฃู ุงูุตู..."onkeyup=filterLibraryLocal()> <select id=lib-filter-cls style=flex:1 onchange=loadPublicLibrary()> <option value=All>ูู ุงูุตููู</option> </select> <select id=lib-filter-subj style=flex:1 onchange=loadPublicLibrary()> <option value=All>ูู ุงูููุงุฏ</option> </select> <button class="btn btn-p"style="width:auto;padding:0 30px"onclick=loadPublicLibrary()>ุชุญุฏูุซ<i class="fas fa-sync"></i></button> </div> <div id=public-lib-grid class=grid> <div style=grid-column:1/-1;text-align:center;padding:40px;color:#94a3b8>ุฌุงุฑู ุชุญููู ุงูููุชุจุฉ...</div> </div> </div> <div id=file-preview-ui class=hidden> <div class=container style=max-width:900px> <button class="btn btn-o"onclick=showPublicLibrary() style=width:auto;margin-bottom:15px> <i class="fas fa-arrow-right"></i>ุนูุฏุฉ ููููุชุจุฉ </button> <div class=doc-preview-wrapper> <div class=doc-container-scrollable id=preview-container-inner> <h2 id=prev-title style="text-align:center;margin-bottom:10px;color:#000;border-bottom:2px solid #000;padding:10px;width:80%"></h2> <div id=content-area style=width:100%;display:flex;flex-direction:column;align-items:center></div> <div id=text-fallback class=hidden style="padding:20px;white-space:pre-line;text-align:right;font-family:'Times New Roman';font-size:18px;line-height:1.8;color:#fff;width:100%;box-sizing:border-box"></div> </div> <div class=doc-overlay> <div class=lock-message-box> <i class="fas fa-lock"style=font-size:40px;color:var(--red);margin-bottom:15px></i> <h3 style="color:#333;margin:0 0 10px 0">ุงูุชูุช ุงููุนุงููุฉ ุงููุฌุงููุฉ</h3> <p style=color:#666;margin-bottom:20px>ูุฅููุงู ุงููุฑุงุกุฉ ูุชุญููู ุงูููู ูุงููุงูุ ูุฑุฌู ุงูุงุดุชุฑุงู ูู ุงูููุตุฉ.</p> <button class="btn btn-g"onclick="showLogin("register")"style="font-size:18px;padding:12px 30px"> <i class="fas fa-unlock"></i>ุงุดุชุฑู ุงูุขู </button> </div> </div> </div> </div> </div> <footer class=landing-footer> <div class=social-links id=footer-socials></div> <p>ยฉ 2024 ููุตุฉ ูุจุฑุงุณ ุงูุชุนููููุฉ. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p> </footer> </div> </div> <div id=auth-container class="container hidden"style=max-width:400px;margin-top:60px> <div class=auth-card> <div style=text-align:center;margin-bottom:20px> <i class="fas fa-arrow-right"style=float:right;cursor:pointer;color:var(--text) onclick=goHome()></i> <h2 id=auth-title style=margin:0;color:var(--text)>ุชุณุฌูู ุงูุฏุฎูู</h2> </div> <div id=f-login> <input id=le placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"dir=ltr> <input id=lp type=password placeholder="ูููุฉ ุงููุฑูุฑ"dir=ltr> <button class="btn btn-p"onclick=login()>ุฏุฎูู<i class="fas fa-sign-in-alt"></i></button> </div> <div id=f-reg class=hidden> <div style="border:2px dashed var(--border);padding:15px;border-radius:10px;margin-bottom:15px;cursor:pointer;text-align:center"onclick="document.getElementById("rp").click()"id=ph-box> <span id=p-txt style=color:#94a3b8><i class="fas fa-camera"></i>ุตูุฑุฉ ุดุฎุตูุฉ</span> <input type=file id=rp hidden onchange=readP(this)> </div> <input id=rc placeholder="ููุฏ ุงูุชูุนูู"required> <input id=rn placeholder="ุงูุงุณู ุงูุฑุจุงุนู (ูุทููุจ)"required minlength=10> <input id=rph placeholder="ุฑูู ุงููุงุชู (07xxxxxxxx)"required pattern=07[789][0-9]{7}> <input id=re type=email placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"dir=ltr required> <input id=rpa type=password placeholder="ูููุฉ ุงููุฑูุฑ"dir=ltr required minlength=6> <button class="btn btn-g"onclick=reg()>ุชูุนูู ุงูุงุดุชุฑุงู</button> <button class="btn btn-o"onclick="switchAuth("login")">ุนูุฏุฉ ููุฏุฎูู</button> </div> <div id=f-trial class=hidden> <p style=color:var(--gold);text-align:center;font-size:.9em>ุงุณุชูุชุน ุจุชุฌุฑุจุฉ ูุงููุฉ ููุฏุฉ 24 ุณุงุนุฉ!</p> <input id=tn placeholder="ุงูุงุณู ุงูุฑุจุงุนู"> <input id=tph placeholder="ุฑูู ุงููุงุชู"> <select id=tcl class="form-select mb-3"> <option value=""disabled selected>ุฌุงุฑู ุชุญููู ุงูุตููู...</option> </select> <input id=te placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"dir=ltr> <button class="btn btn-p"onclick=createTrial()>ุจุฏุก ุงูุชุฌุฑุจุฉ ุงูุขู ๐</button> <button class="btn btn-o"onclick="switchAuth("login")">ุฅูุบุงุก</button> </div> </div> </div> <div id=v-dash class="container hidden"> <div class=card style=display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px> <div style=display:flex;align-items:center;gap:15px;text-align:right> <div style=position:relative> <img id=u-img src=""style="width:75px;height:75px;border-radius:50%;object-fit:cover;border:3px solid var(--blue);background:#333"> <div onclick=editProfile() style=position:absolute;bottom:0;left:0;background:var(--gold);color:#000;width:25px;height:25px;border-radius:50%;display:flex;justify-content:center;align-items:center;cursor:pointer title="ุชุนุฏูู ุงูููู"> <i class="fas fa-pen"style=font-size:12px></i> </div> </div> <div> <h3 id=u-name style=margin:0;color:var(--text);font-size:20px></h3> <span id=u-cls style="color:var(--gold);font-size:14px;background:rgba(245,158,11,.1);padding:2px 8px;border-radius:10px"></span> <div id=social-box style=display:flex;gap:10px;margin-top:8px></div> <button class="btn btn-g btn-sm"onclick=joinClassGroup() style="width:auto;margin-top:5px;padding:5px 15px"> <i class="fab fa-whatsapp"></i>ูุฌููุนุฉ ุงูุตู </button> <div id=badges-area style=margin-top:5px></div> </div> </div> <div style=display:flex;flex-direction:column;gap:5px> <button class="btn btn-o"style=width:auto;color:var(--red);border-color:var(--red) onclick=logout()><i class="fas fa-power-off"></i>ุฎุฑูุฌ</button> </div> </div> <div id=dashboard-news-section class="news-ticker-container hidden"style=border-left-color:var(--blue)> <div class=news-label style="background:var(--blue);font-weight:700;color:#fff;padding:5px 10px;border-radius:5px;display:inline-block">ุชูููู:</div> <div class=news-content style=display:inline-block;margin-right:10px><span id=dashboard-news-text></span></div> </div> <div class=nav-tabs> <div class="nav-tab active"onclick="switchTab("exams",this)"><i class="fas fa-file-alt"></i>ุงูุงูุชุญุงูุงุช</div> <div class=nav-tab onclick="switchTab("library",this)"><i class="fas fa-book-reader"></i>ููุชุจุฉ ุงูุตู</div> <div class=nav-tab onclick="switchTab("assign",this)"><i class="fas fa-upload"></i>ุงููุงุฌุจุงุช</div> <div class=nav-tab onclick="switchTab("leader",this)"><i class="fas fa-crown"></i>ุงูุฃูุงุฆู</div> <div class=nav-tab onclick="switchTab("history",this)"><i class="fas fa-history"></i>ุณุฌูู</div> <div class=nav-tab onclick="switchTab("notes",this)"><i class="fas fa-sticky-note"></i>ูููุฑุชู</div> </div> <div id=tab-exams> <div id=exams-container class=grid></div> </div> <div id=tab-library class=hidden> <div class=card> <h3 style=color:var(--gold);margin-top:0><i class="fas fa-book-open"></i>ููุชุจุฉ ููุตุงุฏุฑ ุงูุชุนูู</h3> <p style=color:#94a3b8;font-size:.9em;margin-bottom:20px>ุฌููุน ุงููููุงุช ุงูุฎุงุตุฉ ุจุตูู ูุชุงุญุฉ ููุชุญููู ูุฌุงูุงู.</p> <div id=std-lib-list></div> </div> </div> <div id=tab-assign class=hidden> <h3 style=text-align:right;color:var(--green);margin-top:10px><i class="fas fa-file-upload"></i>ุชุณููู ุงููุงุฌุจุงุช</h3> <div class=card> <label>ููุน ุงููุงุฌุจ:</label> <select id=as-type><option value="ูุฑูุฉ ุนูู">ูุฑูุฉ ุนูู<option value="ููุถูุน ุชุนุจูุฑ">ููุถูุน ุชุนุจูุฑ</select> <label>ุงููุตู:</label> <textarea id=as-desc rows=3 placeholder=ููุงุญุธุงุชู...></textarea> <div style="border:2px dashed var(--border);padding:20px;border-radius:12px;margin-bottom:15px;cursor:pointer;text-align:center"onclick="document.getElementById("as-file").click()"> <i class="fas fa-cloud-upload-alt fa-2x"style=color:var(--blue)></i><br>ุงุถุบุท ูุฑูุน ููู <input type=file id=as-file hidden onchange=readAsFile(this)> <div id=as-fname style=margin-top:5px;color:#94a3b8;font-size:12px></div> </div> <button class="btn btn-p"onclick=uploadAss()>ุฅุฑุณุงู ุงููุงุฌุจ<i class="fas fa-paper-plane"></i></button> </div> </div> <div id=tab-leader class=hidden> <div class=card style="margin-top:10px;border-top:4px solid var(--gold)"> <h3 style="color:var(--gold);margin:0 0 15px 0;text-align:right"><i class="fas fa-crown"></i>ููุญุฉ ุงููุชุตุฏุฑูู</h3> <table id=leader-tbl><thead><tr><th>#<th>ุงูุทุงูุจ<th>ุงูุฏุฑุฌุฉ<tbody id=leader-body></table> </div> </div> <div id=tab-history class=hidden> <div style=display:flex;justify-content:space-between;align-items:center;margin-top:10px> <h3 style=text-align:right;color:var(--green);margin:0><i class="fas fa-history"></i>ุณุฌูู ุงูุฏุฑุงุณู</h3> <button class="btn btn-g"style="width:auto;padding:5px 15px"onclick=genReport()>๐ ุชูุฑูุฑ PDF</button> </div> <div class=card style=margin-top:15px> <h4 style="margin:0 0 10px 0;color:#94a3b8">ููุงุฑูุฉ ูุน ูุชูุณุท ุงูุตู</h4> <div id=perf-chart class=chart-box> <div style=text-align:center;flex:1>ุฌุงุฑู ุงูุชุญููู...</div> </div> </div> <div class=card style=padding:0;overflow:hidden> <table><thead><tr><th>ุงูุงูุชุญุงู<th>ุงูุฏุฑุฌุฉ<th>ุงูุฅุฌุฑุงุก<tbody id=res-list></table> </div> </div> <div id=tab-notes class=hidden> <h3 style=text-align:right;color:var(--text);margin-top:10px><i class="fas fa-sticky-note"></i>ูููุฑุชู ุงูุฎุงุตุฉ</h3> <div class=card> <textarea id=my-notes rows=10 placeholder="ุงูุชุจ ููุงุญุธุงุชู ููุญูุธ ููุง..."></textarea> <button class="btn btn-p"onclick=saveNotes()>ุญูุธ ุงูููุงุญุธุงุช<i class="fas fa-save"></i></button> </div> </div> </div> <div id=v-exam class="container hidden"> <div class=card style=position:sticky;top:10px;z-index:100;backdrop-filter:blur(20px);background:rgba(15,23,42,.9)> <div style=display:flex;justify-content:space-between;align-items:center> <div> <h2 id=xt style=margin:0;color:var(--blue);font-size:18px></h2> <div style=font-size:12px;color:#94a3b8>ุนุฏุฏ ุงูุฃุณุฆูุฉ:<span id=q-count></span></div> </div> <div style=display:flex;gap:10px;align-items:center> <div id=exam-timer style=font-family:Amiri;font-weight:700;color:var(--text);font-size:1.2em;display:none>00:00</div> <button class="btn btn-o"style="width:auto;padding:8px 15px;font-size:.9em;border-color:var(--gold);color:var(--gold)"onclick=markForReview()> <i class="fas fa-flag"></i>ูุฑุงุฌุนุฉ </button> <button class="btn btn-r"style="width:auto;padding:5px 15px;font-size:12px"onclick=exitExam()>ุฎุฑูุฌ<i class="fas fa-door-open"></i></button> </div> </div> <div style=height:4px;background:#444;margin-top:10px;border-radius:2px;overflow:hidden> <div id=exam-progress style=height:100%;width:0%;background:var(--green);transition:.3s></div> </div> </div> <div class=card id=q-card> <div id=q-box style=text-align:right></div> <div style="height:1px;background:var(--border);margin:20px 0"></div> <div style=display:flex;gap:10px;justify-content:space-between> <button class="btn btn-o"style=width:auto onclick=nav(-1)><i class="fas fa-arrow-right"></i>ุงูุณุงุจู</button> <div id=qs-dots style=display:flex;gap:5px;flex-wrap:wrap;justify-content:center;max-width:50%></div> <button class="btn btn-p"style=width:auto onclick=nav(1)>ุงูุชุงูู<i class="fas fa-arrow-left"></i></button> </div> <button id=s-btn class="btn btn-g hidden"onclick=sub() style=margin-top:20px>ุฅููุงุก ูุชุณููู ุงูุงูุชุญุงู<i class="fas fa-check-circle"></i></button> </div> </div> <div id=review-modal class="container hidden"style=position:fixed;top:0;left:0;right:0;bottom:0;z-index:4000;overflow-y:auto;background:var(--bg);max-width:100%> <div class=container style=max-width:800px;margin-top:20px> <div class=card style="border-top:4px solid var(--blue)"> <div id=cert-review-btn style=text-align:center;margin-bottom:20px class=hidden> <button class="btn btn-g"style=width:auto;display:inline-flex onclick=cert(st.title,st.lastScore)>๐ ุชุญููู ุงูุดูุงุฏุฉ ุงูุขู</button> </div> <h2 style=text-align:center;color:var(--text)>ูุฑุงุฌุนุฉ ุงูุฅุฌุงุจุงุช ุงููููุฐุฌูุฉ</h2> <div id=review-content></div> <button class="btn btn-o"onclick=closeReview()>ุฅุบูุงู ุงููุฑุงุฌุนุฉ ูุงูุนูุฏุฉ</button> </div> </div> </div> <div id=cert-modal> <div class=cert-scaler> <div class=cert-box id=cert-node> <div style=text-align:center;margin-bottom:10px> <img src=https://i.ibb.co/VrJsk41/Gemini-Generated-Image-u0u4kwu0u4kwu0u4.png alt=Logo style="width:80px;height:80px;border-radius:50%;object-fit:cover;margin-bottom:10px;border:2px solid #f59e0b"> <h2 style=color:#1e3a8a;margin:0;font-family:Amiri;font-size:32px>ููุตุฉ ูุจุฑุงุณ</h2> <p style=color:#d97706;margin:0;font-size:16px>ููุชููุฒ ูุงูุฅุจุฏุงุน</p> </div> <img id=c-img class=cert-student-img src=""> <h1 style="font-family:Amiri;font-size:48px;color:#1e3a8a;margin:10px 0">ุดูุงุฏุฉ ุชููู</h1> <p style="font-size:24px;margin:10px 0">ูุณุฑูุง ููุญ ุงูุทุงูุจ/ุฉ:</p> <h2 id=c-name style="color:#000;font-size:38px;margin:5px 0;border-bottom:2px solid #ccc;display:inline-block;padding:0 40px;font-family:Amiri"></h2> <p style=margin-top:20px;font-size:20px>ูุงุฌุชูุงุฒู ุงุฎุชุจุงุฑ<b id=c-ex style=color:#d97706></b>ุจูุชูุฌุฉ:</p> <h1 id=c-sc style="color:#1e3a8a;font-size:60px;margin:10px 0;font-family:Tajawal"></h1> <div style="margin-top:60px;display:flex;justify-content:space-between;align-items:flex-end;padding:0 30px"> <div style=text-align:right> <p style=margin:0;font-weight:700;color:#555;font-size:18px>ูุฏูุฑ ุงูููุตุฉ</p> <h3 id=t-name style="margin:5px 0;font-family:Amiri;font-size:30px;color:#000">ุฃ. ุนุจุฏ ุงูุฑุญูู ูุตุฑ ุงููู</h3> </div> <div style=position:relative;width:160px;height:130px> <img id=stamp-img src=""class=stamp-seal crossorigin=anonymous> </div> </div> </div> </div> <div style=position:absolute;bottom:20px;width:100%;text-align:center;z-index:9999;display:flex;gap:10px;justify-content:center> <button class="btn btn-g"style="width:auto;padding:10px 40px"onclick=dlCert()>๐พ ุญูุธ ุงูุตูุฑุฉ</button> <button class="btn btn-o"style=width:auto;background:#fff;color:#000 onclick="document.getElementById("cert-modal").style.display="none"">ุฅุบูุงู</button> </div> </div> <script> // ================= Configuration ================= // โ๏ธ ุถุน ุงูุฑุงุจุท ุงูุฌุฏูุฏ ููุง const API_URL = "https://script.google.com/macros/s/AKfycbyJ8FX2Hd_OAakWU0Gbo35jcLq5b-tjwGdoGb4RimJtJCfgZqWnM4OSa7kGV-usUwgX/exec"; const STAMP_URL = "https://i.ibb.co/Cs658hNV/Gemini-Generated-Image-7gpx1j7gpx1j7gpx.png"; const DEF_IMG = 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png'; let token = localStorage.getItem('tk'); let publicSettings = {}; let deviceId = localStorage.getItem('did'); if (!deviceId) { deviceId = 'dev_' + Math.random().toString(36).substr(2, 9) + Date.now(); localStorage.setItem('did', deviceId); } let st = { photo:null, exam:[], ans:{}, idx:0, title:'', cheats:0, lastScore: 0, assignFile: null, assignName: '', marked: [], timerInterval: null }; let allSubjects = []; let publicLibData = []; // ================= Core Logic & Smart Caching ================= let loaderCount = 0; function showLoader(s) { if(s) loaderCount++; else loaderCount = Math.max(0, loaderCount - 1); document.getElementById('loader').style.display = loaderCount > 0 ? 'flex' : 'none'; } function showToast(msg, type='success') { // Basic Toast implementation const Toast = Swal.mixin({ toast: true, position: 'top-end', showConfirmButton: false, timer: 3000, timerProgressBar: true, didOpen: (toast) => { toast.addEventListener('mouseenter', Swal.stopTimer); toast.addEventListener('mouseleave', Swal.resumeTimer); } }); Toast.fire({ icon: type, title: msg }); } async function callApi(action, data = {}) { if(action !== 'getPublicData' && action !== 'getLeaderboard') showLoader(true); data.action = action; data._t = Date.now(); if(API_URL) { try { const response = await fetch(API_URL + '?cb=' + Date.now(), { method: "POST", redirect: "follow", headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(data) }); const textData = await response.text(); showLoader(false); return JSON.parse(textData); } catch (e) { console.warn(e); showLoader(false); showToast('ุฎุทุฃ ูู ุงูุงุชุตุงูุ ูุฑุฌู ุงูุชุญูู ูู ุงูุฅูุชุฑูุช', 'error'); return { success: false, message: 'ุฎุทุฃ ูู ุงูุงุชุตุงู' }; } } } function safePushState(state, title, url) { try { window.history.pushState(state, title, url); } catch (e) {} } // โก ุชุญุณูู 1: ุฅุตูุงุญ ุชุญููู ุงูุตูุญุฉ ูุงูุฑูุงุจุท ุงููุจุงุดุฑุฉ window.onload = function() { document.getElementById('stamp-img').src = STAMP_URL; const urlParams = new URLSearchParams(window.location.search); const viewMode = urlParams.get('view'); const fileId = urlParams.get('id'); const examParam = urlParams.get('exam'); // Load public data in background (don't block UI) // โก ุชุญุณูู 2: ุชุณุฑูุน ุงููุงุฌูุฉ ุจุฌุนู ุงูุฌูุจ ูู ุงูุฎูููุฉ ูุน ุงููุงุด loadCachedPublicData(); fetchPublicData(); if(viewMode === 'library') { showPublicLibrary(); } else if(viewMode === 'file' && fileId) { loadPublicFilePreview(fileId); } else if (examParam) { // โกโก DIRECT LINK FIX โกโก if(token) { // If logged in, go straight to exam, bypass home document.getElementById('landing-page').classList.add('hidden'); start(examParam); } else { // If not logged in, save param and show login sessionStorage.setItem('pending', examParam); showLogin('login'); } } else { // Normal Load if(token) loadDash(); else goHome(); } document.addEventListener("visibilitychange", () => { if(document.hidden && !document.getElementById('v-exam').classList.contains('hidden')){ st.cheats++; } }); }; function goHome() { safePushState({}, '', window.location.pathname); ['public-library-ui', 'file-preview-ui', 'auth-container', 'v-dash', 'v-exam'].forEach(id => document.getElementById(id).classList.add('hidden')); document.getElementById('landing-page').classList.remove('hidden'); document.getElementById('home-view').classList.remove('hidden'); } function navToSection(id) { goHome(); setTimeout(() => { const el = document.getElementById(id); if(el) el.scrollIntoView({behavior: 'smooth'}); }, 100); } // โก ุชุญุณูู 3: ุฅุตูุงุญ ุนุฑุถ ุฃุณุนุงุฑ ุงููุชุฌุฑ ูุงููุงุด function loadCachedPublicData() { let cached = localStorage.getItem('publicData_cache'); if(cached) { try { renderPublicUI(JSON.parse(cached)); console.log("Loaded from cache"); } catch(e) {} } } function fetchPublicData() { // Non-blocking call let payload = {action: 'getPublicData', _t: Date.now()}; fetch(API_URL, { method: "POST", redirect: "follow", headers: { "Content-Type": "text/plain;charset=utf-8" }, body: JSON.stringify(payload) }).then(r => r.json()).then(r => { if(r && r.success) { localStorage.setItem('publicData_cache', JSON.stringify(r)); renderPublicUI(r); } }).catch(e => console.log("Bg fetch error")); } function renderPublicUI(r) { publicSettings = r.settings || {}; // ๐ฐ UPDATE PRICES DYNAMICALLY if(publicSettings.Price_Gold) document.getElementById('disp-price-gold').innerText = publicSettings.Price_Gold; if(publicSettings.Price_Term) document.getElementById('disp-price-term').innerText = publicSettings.Price_Term; if(r.news && r.news.length > 0) { document.getElementById('dashboard-news-text').innerText = r.news[0].text; document.getElementById('dashboard-news-section').classList.remove('hidden'); document.getElementById('news-text').innerText = r.news[0].text; document.getElementById('news-section').classList.remove('hidden'); } if(r.classes) { let opts = '<option value="All">ูู ุงูุตููู</option>'; let trialOpts = '<option value="" disabled selected>ุฌุงุฑู ุชุญููู ุงูุตููู...</option>'; r.classes.forEach(c => { opts += `<option value="${c}">${c}</option>`; trialOpts += `<option value="${c}">${c}</option>`; }); document.getElementById('lib-filter-cls').innerHTML = opts; document.getElementById('tcl').innerHTML = trialOpts; } if(publicSettings.WhatsApp_Link) { let waUrl = `https://wa.me/${String(publicSettings.WhatsApp_Link).replace(/\D/g,'')}`; document.getElementById('wa-btn').href = waUrl; document.getElementById('wa-btn').classList.remove('hidden'); } } function buyPlan(planName) { let waNum = publicSettings.WhatsApp_Link ? String(publicSettings.WhatsApp_Link).replace(/\D/g,'') : '96270000000'; window.open(`https://wa.me/${waNum}?text=${encodeURIComponent('ูุฑุญุจุงูุ ุฃุฑุบุจ ุจุงูุงุดุชุฑุงู ูู ' + planName)}`, '_blank'); } function showPublicLibrary() { safePushState({view:'library'}, '', '?view=library'); ['home-view', 'file-preview-ui'].forEach(id => document.getElementById(id).classList.add('hidden')); document.getElementById('public-library-ui').classList.remove('hidden'); document.getElementById('landing-page').classList.remove('hidden'); loadPublicLibrary(); } function loadPublicLibrary() { let cls = document.getElementById('lib-filter-cls').value; let subj = document.getElementById('lib-filter-subj').value; document.getElementById('public-lib-grid').innerHTML = '<div style="grid-column:1/-1;text-align:center">ุฌุงุฑู ุงูุจุญุซ...</div>'; callApi('getPublicLibraryData', {filterClass: cls, filterSubject: subj}).then(r => { if(r.success) { publicLibData = r.list; // For local search renderLibGrid(publicLibData); } }); } function renderLibGrid(list) { let div = document.getElementById('public-lib-grid'); div.innerHTML = ''; if(list.length > 0) { list.forEach(f => { let icon = f.type === 'Video' ? 'fa-play-circle text-danger' : 'fa-file-pdf text-danger'; div.innerHTML += `<div class="file-card fade-in" onclick="gotoFile(${f.id})"><div style="text-align:center"><i class="fas ${icon} file-icon"></i><h3 style="margin:0; font-size:1.1em">${f.title}</h3></div><div style="margin-top:auto"><div class="file-meta"><span>${f.cls}</span><span>${f.subject}</span></div><button class="btn btn-o" style="width:100%">ูุนุงููุฉ</button></div></div>`; }); } else { div.innerHTML = '<p style="grid-column:1/-1; text-align:center; color:#94a3b8">ูุง ุชูุฌุฏ ูุชุงุฆุฌ</p>'; } } function filterLibraryLocal() { let term = document.getElementById('lib-search-input').value.toLowerCase(); let filtered = publicLibData.filter(f => f.title.toLowerCase().includes(term) || f.subject.toLowerCase().includes(term) || f.cls.toLowerCase().includes(term)); renderLibGrid(filtered); } function gotoFile(id) { safePushState({view:'file', id:id}, '', '?view=file&id='+id); loadPublicFilePreview(id); } function loadPublicFilePreview(id) { document.getElementById('home-view').classList.add('hidden'); document.getElementById('public-library-ui').classList.add('hidden'); document.getElementById('landing-page').classList.remove('hidden'); document.getElementById('file-preview-ui').classList.remove('hidden'); document.getElementById('prev-title').innerText = "ุฌุงุฑู ุงูุชุญููู..."; const container = document.getElementById('content-area'); const fallbackBox = document.getElementById('text-fallback'); container.innerHTML = ''; fallbackBox.classList.add('hidden'); callApi('getPublicFileDetails', {fileId: id}).then(r => { if(r.success) { document.getElementById('prev-title').innerText = r.data.title; let pdfUrl = r.data.link; if(pdfUrl && (pdfUrl.includes('drive.google.com') || pdfUrl.includes('docs.google.com'))) { const fileIdMatch = pdfUrl.match(/[-\w]{25,}/); if(fileIdMatch) { container.innerHTML = `<iframe src="https://drive.google.com/file/d/${fileIdMatch[0]}/preview" class="doc-iframe" allow="autoplay"></iframe>`; return; } } if(pdfUrl && (r.data.type === 'PDF' || pdfUrl.endsWith('.pdf'))) { pdfjsLib.getDocument(pdfUrl).promise.then(async function(pdf) { let allowedPages = Math.ceil(pdf.numPages * 0.3) || 1; for(let i = 1; i <= allowedPages; i++) { const page = await pdf.getPage(i); const viewport = page.getViewport({scale: 1.5}); const canvas = document.createElement('canvas'); canvas.className = 'doc-canvas'; canvas.height = viewport.height; canvas.width = viewport.width; container.appendChild(canvas); await page.render({canvasContext: canvas.getContext('2d'), viewport: viewport}).promise; } }).catch(err => { fallbackBox.innerText = r.data.desc || "ุนุฑุถ ุบูุฑ ูุชุงุญุ ุงุดุชุฑู ููุชุญููู."; fallbackBox.classList.remove('hidden'); }); } else { fallbackBox.innerText = r.data.desc || "ูุง ููุฌุฏ ูุตู."; fallbackBox.classList.remove('hidden'); } } else { document.getElementById('prev-title').innerText = "ููู ุบูุฑ ููุฌูุฏ"; } }); } // ================= Auth & User ================= function showLogin(type) { document.getElementById('landing-page').classList.add('hidden'); document.getElementById('auth-container').classList.remove('hidden'); switchAuth(type); } function switchAuth(type) { ['f-login', 'f-reg', 'f-trial'].forEach(id => document.getElementById(id).classList.add('hidden')); let title = type === 'register' ? 'ุชูุนูู ุงุดุชุฑุงู ุฌุฏูุฏ' : type === 'trial' ? 'ุชุฌุฑุจุฉ ูุฌุงููุฉ' : 'ุชุณุฌูู ุงูุฏุฎูู'; document.getElementById('auth-title').innerText = title; if(type === 'register') document.getElementById('f-reg').classList.remove('hidden'); else if(type === 'trial') document.getElementById('f-trial').classList.remove('hidden'); else document.getElementById('f-login').classList.remove('hidden'); } function login(){ let e=document.getElementById('le').value, p=document.getElementById('lp').value; callApi('loginUser', {email:e, pass:p, deviceId:deviceId}).then(r=>{ if(r.success){ sv(r); checkPending(); } else Swal.fire('ุฎุทุฃ',r.message,'error'); }); } function reg(){ let d={code:document.getElementById('rc').value, name:document.getElementById('rn').value, phone:document.getElementById('rph').value, email:document.getElementById('re').value, password:document.getElementById('rpa').value, photoData:st.photo, deviceId:deviceId}; if(!d.code || d.name.split(' ').length<3 || !/^07[789]\d{7}$/.test(d.phone)) return Swal.fire('ุชูุจูู', 'ุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ', 'warning'); callApi('registerStudent', {d:d}).then(r=>{ if(r.success){ sv(r); Swal.fire('ุชู','ุฃููุงู ุจู','success').then(checkPending); } else Swal.fire('ุฎุทุฃ',r.message,'error'); }); } function createTrial() { let d = { name: document.getElementById('tn').value, phone: document.getElementById('tph').value, classLevel: document.getElementById('tcl').value, email: document.getElementById('te').value, deviceId: deviceId }; if(!d.name || !d.email || !d.classLevel) return Swal.fire('ุชูุจูู','ุฃููู ุงูุจูุงูุงุช','warning'); callApi('createTrialAccount', {d:d}).then(r => { if(r.success) { sv(r); Swal.fire({ title: '๐ ุชู ุชูุนูู ุงูุชุฌุฑุจุฉ!', html: `ูููุฉ ุงููุฑูุฑ: <b>${r.tempPass}</b>`, icon: 'success' }).then(checkPending); } else Swal.fire('ุฎุทุฃ', r.message, 'error'); }); } function sv(r){ localStorage.setItem('tk',r.token); localStorage.setItem('nm',r.name); localStorage.setItem('cl',r.classLevel); if(r.photo) localStorage.setItem('ph', r.photo); token=r.token; } function checkPending(){ let p=sessionStorage.getItem('pending'); if(p){ sessionStorage.removeItem('pending'); start(p); } else loadDash(); } function logout(){ localStorage.clear(); location.reload(); } // ================= Dashboard ================= function loadDash(){ document.getElementById('landing-page').classList.add('hidden'); document.getElementById('auth-container').classList.add('hidden'); document.getElementById('v-exam').classList.add('hidden'); document.getElementById('v-dash').classList.remove('hidden'); document.getElementById('u-name').innerText = localStorage.getItem('nm'); document.getElementById('u-cls').innerText = localStorage.getItem('cl'); let ph = localStorage.getItem('ph'); document.getElementById('u-img').src = ph ? ph : DEF_IMG; // Background Fetches callApi('getExamsList', {token:token}).then(r=>{ allSubjects = r.subjects || []; renderSubjects(); }); callApi('getLeaderboard', {token:token}).then(r=>{ let h=''; if(r.list) r.list.forEach((l,i)=> h+=`<tr><td style="color:var(--gold); font-weight:bold">${i+1}</td><td>${l.name}</td><td style="font-weight:bold; color:var(--blue)">${l.score}%</td></tr>`); document.getElementById('leader-body').innerHTML=h || '<tr><td colspan="3">ูุง ููุฌุฏ</td></tr>'; }); callApi('getStudentResults', {token:token}).then(r=>{ let h=''; if(r.results) r.results.forEach(x=> h+=`<tr><td>${x.exam}</td><td style="color:${x.percent>=50?'var(--green)':'var(--red)'}">${x.percent}%</td><td>${x.percent>=50?`<button class="btn btn-g btn-sm" onclick="cert('${x.exam}','${x.percent}')"><i class="fas fa-certificate"></i></button>`:'-'}</td></tr>`); document.getElementById('res-list').innerHTML=h; }); loadStats(); } function switchTab(tabId, el) { ['exams', 'library', 'leader', 'history', 'assign', 'notes'].forEach(id => document.getElementById('tab-'+id).classList.add('hidden')); document.getElementById('tab-'+tabId).classList.remove('hidden'); document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active')); el.classList.add('active'); if(tabId === 'history') loadStats(); if(tabId === 'library') loadStudentLibrary(); } function renderSubjects() { let h = ''; if(allSubjects.length === 0) h = '<p style="text-align:center;">ูุง ุชูุฌุฏ ุงูุชุญุงูุงุช.</p>'; else allSubjects.forEach((sub, idx) => h += `<div class="exam-item folder-item" onclick="openSubject(${idx})"><i class="fas fa-book exam-icon"></i><h3>${sub.name}</h3><div style="font-size:13px; color:#94a3b8">${sub.exams.length} ุงูุชุญุงู</div></div>`); document.getElementById('exams-container').innerHTML = h; } function openSubject(idx) { let sub = allSubjects[idx]; let h = `<div style="display:flex; justify-content:space-between; margin-bottom:15px; align-items:center"><h3 style="color:var(--gold); margin:0">${sub.name}</h3><button class="btn btn-o btn-sm" onclick="renderSubjects()">โฉ ุนูุฏุฉ</button></div>`; sub.exams.forEach(x => h += `<div class="exam-item fade-in" onclick="start('${x.title}')"><i class="fas fa-file-alt exam-icon"></i><h3>${x.title}</h3></div>`); document.getElementById('exams-container').innerHTML = h; } function loadStudentLibrary() { document.getElementById('std-lib-list').innerHTML = 'ุฌุงุฑู ุงูุชุญููู...'; callApi('getLibraryContent', {token:token}).then(r => { let h = ''; if(r.library && r.library.length) r.library.forEach(f => h += `<div class="lib-item"><i class="fas ${f.type==='Video'?'fa-play-circle text-danger':'fa-file-pdf text-danger'} fa-2x"></i><div style="flex:1; margin:0 15px"><b>${f.title}</b><div style="font-size:0.8em; color:#94a3b8">${f.subject}</div></div><a href="${f.link}" target="_blank" class="btn btn-g btn-sm">ุชุญููู</a></div>`); else h = '<p>ูุง ุชูุฌุฏ ูููุงุช.</p>'; document.getElementById('std-lib-list').innerHTML = h; }); } function filterStdLib() { let term = document.getElementById('std-lib-search').value.toLowerCase(); let items = document.querySelectorAll('.lib-item'); items.forEach(item => { if(item.innerText.toLowerCase().includes(term)) item.style.display = 'flex'; else item.style.display = 'none'; }); } function loadStats() { callApi('getStudentStats', {token:token}).then(r => { if(!r.success) return; document.getElementById('perf-chart').innerHTML = `<div class="chart-bar chart-me" style="height:${r.myAvg}%;"><span>${r.myAvg}%</span></div><div class="chart-bar chart-cls" style="height:${r.classAvg}%;"><span>${r.classAvg}%</span></div>`; let b = ''; if(r.badges) r.badges.forEach(badge => b += `<span class="badge-item"><i class="fas fa-medal"></i> ${badge}</span>`); document.getElementById('badges-area').innerHTML = b; let sHtml = ''; if(r.socials) { if(r.socials.facebook) sHtml += `<a href="${r.socials.facebook}" target="_blank" style="color:#1877F2; font-size:24px"><i class="fab fa-facebook"></i></a>`; if(r.socials.instagram) sHtml += `<a href="${r.socials.instagram}" target="_blank" style="color:#C13584; font-size:24px"><i class="fab fa-instagram"></i></a>`; if(r.socials.youtube) sHtml += `<a href="${r.socials.youtube}" target="_blank" style="color:#FF0000; font-size:24px"><i class="fab fa-youtube"></i></a>`; if(r.socials.whatsapp) { document.getElementById('wa-btn').href = r.socials.whatsapp; document.getElementById('wa-btn').classList.remove('hidden'); } } document.getElementById('social-box').innerHTML = sHtml; }); } // ================= Exam System ================= function start(t){ callApi('getExamQuestions', {token:token, name:t}).then(r=>{ // โก FIX: Don't logout on error, stay in dashboard if(!r || !r.success) { return Swal.fire('ุชูุจูู', r ? r.message : 'ุฎุทุฃ ุบูุฑ ูุนุฑูู', 'warning').then(() => { if(token) loadDash(); else goHome(); }); } st.exam=r.questions; st.title=t; st.idx=0; st.ans={}; st.cheats=0; st.marked=[]; st.startTime = Date.now(); if(st.timerInterval) clearInterval(st.timerInterval); document.getElementById('exam-timer').style.display = 'block'; st.timerInterval = setInterval(updateTimer, 1000); document.getElementById('v-dash').classList.add('hidden'); document.getElementById('v-exam').classList.remove('hidden'); document.getElementById('xt').innerText=t; document.getElementById('q-count').innerText = st.exam.length; renderDots(); rendQ(); }); } function updateTimer() { let diff = Math.floor((Date.now() - st.startTime) / 1000); let m = Math.floor(diff / 60).toString().padStart(2,'0'); let s = (diff % 60).toString().padStart(2,'0'); document.getElementById('exam-timer').innerText = `${m}:${s}`; } function renderDots() { let h = ''; st.exam.forEach((_, i) => { h += `<div id="dot-${i}" style="width:12px; height:12px; border-radius:50%; background:#444; transition:0.3s; cursor:pointer" onclick="navToQ(${i})"></div>`; }); document.getElementById('qs-dots').innerHTML = h; } function updateDots() { st.exam.forEach((_, i) => { let el = document.getElementById(`dot-${i}`); if(i === st.idx) { el.style.background = 'var(--blue)'; el.style.transform = 'scale(1.4)'; } else if(st.marked.includes(i)) el.style.background = 'var(--gold)'; else if(st.ans[st.exam[i].id]) el.style.background = 'var(--green)'; else { el.style.background = '#444'; el.style.transform = 'scale(1)'; } }); } function navToQ(i) { st.idx = i; rendQ(); } function rendQ(){ updateDots(); let q=st.exam[st.idx]; let isMarked = st.marked.includes(st.idx); let h=`<h3 style="margin-bottom:20px; display:flex; justify-content:space-between"> <span><span style="color:var(--gold)">ุณ ${st.idx+1}:</span> ${q.text}</span> ${isMarked ? '<i class="fas fa-flag animate__animated animate__rubberBand" style="color:var(--gold)"></i>' : ''} </h3>`; if(q.img) h+=`<img src="${q.img}" style="max-width:100%; border-radius:12px; margin-bottom:20px; border:1px solid var(--border)">`; q.opts.forEach(o=>{ if(o) h+=`<div class="q-option ${st.ans[q.id]==o?'selected':''}" onclick="sl('${o}')"><div class="opt-circle"></div>${o}</div>` }); document.getElementById('q-box').innerHTML=h; document.getElementById('s-btn').classList.toggle('hidden', st.idx!=st.exam.length-1); let filled = Object.keys(st.ans).length; document.getElementById('exam-progress').style.width = ((filled / st.exam.length) * 100) + '%'; } function sl(v){ st.ans[st.exam[st.idx].id]=v; rendQ(); } function nav(d){ if(st.idx+d>=0 && st.idx+d<st.exam.length){ st.idx+=d; rendQ(); } } function markForReview() { if(st.marked.includes(st.idx)) st.marked = st.marked.filter(i => i !== st.idx); else st.marked.push(st.idx); rendQ(); showToast(st.marked.includes(st.idx) ? 'ุชู ุงูุชูููุฒ ูููุฑุงุฌุนุฉ' : 'ุชูุช ุฅุฒุงูุฉ ุงูุชูููุฒ'); } function sub(){ submitExam(false); } function exitExam() { Swal.fire({ title: 'ุชุฃููุฏ ุงูุฎุฑูุฌุ', icon: 'warning', showCancelButton: true, confirmButtonColor: '#ef4444' }).then((r) => { if(r.isConfirmed) { clearInterval(st.timerInterval); loadDash(); } }); } function submitExam(forced){ if(!forced && !confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุงูุชุณูููุ')) return; clearInterval(st.timerInterval); callApi('submitExam', {token:token, n:st.title, a:st.ans, cheats:st.cheats}).then(res=>{ // โก FIX: Check success if(!res || !res.success) { return Swal.fire('ุฎุทุฃ', res ? res.message : 'ูุดู ุงูุชุณููู', 'error'); } st.lastScore = res.percent; let isPass = parseInt(res.percent)>=50; if(isPass) confetti(); Swal.fire({ title: isPass?'ูุจุฑูู!':'ุญุธุงู ุฃููุฑ', html:`ุงููุชูุฌุฉ: <b style="font-size:30px;color:${isPass?'green':'red'}">${res.percent}</b>`, icon:isPass?'success':'error', showDenyButton:true, showCancelButton:isPass, confirmButtonText:'ุงูุฑุฆูุณูุฉ', denyButtonText:'ูุฑุงุฌุนุฉ', cancelButtonText:'ุดูุงุฏุฉ' }).then((r) => { if(r.isDenied) showReview(st.title, isPass); else if(r.dismiss===Swal.DismissReason.cancel) cert(st.title, res.percent); else loadDash(); }); }); } function showReview(examTitle, isPass) { callApi('getReviewData', {token:token, title:examTitle}).then(r => { document.getElementById('review-modal').classList.remove('hidden'); if(isPass) document.getElementById('cert-review-btn').classList.remove('hidden'); else document.getElementById('cert-review-btn').classList.add('hidden'); let h = ''; st.exam.forEach((q, i) => { let isCorrect = st.ans[q.id] === r.answers[q.id]; h += `<div style="background:rgba(128,128,128,0.05); padding:20px; border-radius:15px; margin-bottom:15px; border-right:5px solid ${isCorrect?'var(--green)':'var(--red)'}"><p style="font-weight:bold; font-size:1.1em">ุณ${i+1}: ${q.text}</p><div style="font-size:15px; color:#94a3b8">ุฅุฌุงุจุชู: <span style="color:${isCorrect?'var(--green)':'var(--red)'}; font-weight:bold">${st.ans[q.id]||'-'}</span>${!isCorrect?`<br>ุงูุตุญูุญุฉ: <span style="color:var(--green); font-weight:bold">${r.answers[q.id]}</span>`:''}</div></div>`; }); document.getElementById('review-content').innerHTML = h; }); } function closeReview(){ document.getElementById('review-modal').classList.add('hidden'); loadDash(); } // ================= Utilities ================= function cert(e,s){ document.getElementById('c-name').innerText=localStorage.getItem('nm'); document.getElementById('c-ex').innerText=e; document.getElementById('c-sc').innerText=s; document.getElementById('c-img').src=localStorage.getItem('ph')||DEF_IMG; document.getElementById('cert-modal').style.display='flex'; } function dlCert(){ html2canvas(document.getElementById('cert-node'), { scale:3, useCORS:true }).then(c=>{ let a=document.createElement('a'); a.download='Certificate.png'; a.href=c.toDataURL(); a.click(); }); } function readP(i){ if(i.files[0]){ let r=new FileReader(); r.onload=e=>{ let img=new Image(); img.onload=function(){ let c=document.createElement('canvas'); let s=150/img.width; c.width=150; c.height=img.height*s; c.getContext('2d').drawImage(img,0,0,c.width,c.height); st.photo=c.toDataURL('image/jpeg',0.7); document.getElementById('p-txt').innerHTML='<i class="fas fa-check-circle" style="color:var(--green)"></i> ุชู ุงูุงุฎุชูุงุฑ'; }; img.src=e.target.result; }; r.readAsDataURL(i.files[0]); } } function readAsFile(input) { if(input.files[0]) { let f=input.files[0]; document.getElementById('as-fname').innerText=f.name; let r=new FileReader(); r.onload=e=>{ st.assignFile=e.target.result; st.assignName=f.name; }; r.readAsDataURL(f); } } function uploadAss() { if(!st.assignFile) return Swal.fire('ุชูุจูู','ุงุฎุชุฑ ููู','warning'); callApi('uploadStudentAssignment', {token:token, d:{type:document.getElementById('as-type').value, desc:document.getElementById('as-desc').value, fileData:st.assignFile, fileName:st.assignName}}).then(r=>{ if(r.success) { showToast('ุชู ุชุณููู ุงููุงุฌุจ ุจูุฌุงุญ'); document.getElementById('as-file').value = ''; document.getElementById('as-fname').innerText = ''; } }); } function saveNotes() { callApi('saveStudentNote', {token:token, text:document.getElementById('my-notes').value}).then(r => showToast('ุชู ุญูุธ ุงูููุงุญุธุงุช')); } function toggleTheme() { let b=document.body; if(b.getAttribute('data-theme')=='light'){ b.setAttribute('data-theme','dark'); document.getElementById('theme-icon').className='fas fa-moon'; }else{ b.setAttribute('data-theme','light'); document.getElementById('theme-icon').className='fas fa-sun'; } } function editProfile() { Swal.fire({ title:'ุชุนุฏูู ุงูููู', html:`<input type="file" id="sw-f" hidden onchange="readP_SW(this)"><div onclick="document.getElementById('sw-f').click()" style="cursor:pointer;border:2px dashed #ccc;padding:15px; border-radius:10px; margin-bottom:10px">ุชุบููุฑ ุงูุตูุฑุฉ</div><input id="sw-p" type="password" class="swal2-input" placeholder="ูููุฉ ูุฑูุฑ ุฌุฏูุฏุฉ (ุงุฎุชูุงุฑู)">`, showCancelButton:true, preConfirm:()=>{ return {pass:document.getElementById('sw-p').value, photo:window.tempPhoto} } }).then((r)=>{ if(r.isConfirmed) callApi('updateProfile',{token:token, newPass:r.value.pass, newPhoto:r.value.photo}).then(res=>{ if(res.success){ if(r.value.photo) localStorage.setItem('ph',r.value.photo); showToast('ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ'); setTimeout(()=>location.reload(), 1000); } }) }); } function readP_SW(i){ readP(i); setTimeout(()=>{ window.tempPhoto=st.photo; Swal.showValidationMessage('ุชู ุงุฎุชูุงุฑ ุงูุตูุฑุฉ'); }, 500); } function joinClassGroup() { let c=localStorage.getItem('cl'); let l=publicSettings[`Group_${c}`]||publicSettings['WhatsApp_Link']; if(l) window.open(l.includes('http')?l:`https://wa.me/${l.replace(/\D/g,'')}`, '_blank'); else Swal.fire('ุชูุจูู','ุงูุฑุงุจุท ุบูุฑ ูุชููุฑ','info'); } </script>

